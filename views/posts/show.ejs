<!DOCTYPE html>
<html>
  <head>
    <%- include('../partials/head') %>
    <link href="/css/lookboard.css" rel="stylesheet">
    <link href="/css/normal_header.css" rel="stylesheet">
  </head>
  <body>
    <%- include('../partials/normal_header') %>

        <div class="lookboard-pic"></div>
        <div class="section-main-title">
          <h1 id="section-title"  data-search-highlight="title"><%= post.title %></h1>
          <p id="section-writer" data-search-highlight="author"><%= post.author ? post.author.username : "" %></p>
         <div id="section-date"><span data-date-time="<%= post.createdAt %>" ></span></div>
          <% if(post.updatedAt) { %>
            <div><span>Updated</span> : <span data-date-time="<%= post.updatedAt %>"></span></div>
          <% } %>
        </div>


        <div class="container">

        <nav aria-label="breadcrumb">
          <ol class="breadcrumb p-1 pl-2 pr-2">
            <li class="breadcrumb-item"><a href="/">Home</a></li>
            <li class="breadcrumb-item"><a href="/posts">Board</a></li>
            <li class="breadcrumb-item active" aria-current="page"><%= post.title %></li>
          </ol>
        </nav>

        <div class="lookboard">
            <div class="lookboard-content" data-search-highlight="body"><%= post.body %></div>
        </div>

    <div class="mt-3">
        <a class="btn mybtn" href="/posts<%= getPostQueryString() %>">Back</a> <!-- 1 -->
        <% if(isAuthenticated && post.author && currentUser.id == post.author.id){ %>
            <!-- 2 --><a class="btn  mybtn" href="/posts/<%= post._id %>/edit<%= getPostQueryString() %>">Edit</a>
            <!-- 3 --><form action="/posts/<%= post._id %>?_method=delete<%= getPostQueryString(true) %>" method="post" class="d-inline">
                <a class="btn mybtn"  href="javascript:void(0)" onclick="confirm('Do you want to delete this?')?this.parentElement.submit():null;">Delete</a>
            </form>
        <% } %>


        <h4 class="mt-3">Comments</h4>

        <% if(commentTrees.length){ %>
            <div class="mt-3 border-bottom">
                <% commentTrees.forEach(function(comment) { %>
                    <%- include('./partials/comment-show', {
                    post: post,
                    comment: comment,
                    commentForm: commentForm,
                    commentError: commentError,
                    }); %>
                <% }) %>
            </div>
        <% } %>

        <div class="mt-3">
            <%- include('./partials/comment-form', {
            actionUrl:'/comments?postId=' + post._id,
            comment: {},
            commentForm: commentForm,
            commentError: commentError,
            parentComment: null,
            }); %>
        </div>
    </div>
    </div>


    <script src="/js/lookboard.js"></script>
    <script src="/js/script.js"></script>
  </body>
</html>
